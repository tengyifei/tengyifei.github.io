<!doctype html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Passprot exe encryptor 0.2 released | Thinking and Computing</title>
        <!-- Material Library -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/material-design-lite/1.1.3/material.min.css" integrity="sha256-8/FvSMufaMDFDGPISKeLSup0kzLXG2IjRnmpPtcyxjY=" crossorigin="anonymous">
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
        <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Courgette|Raleway:400,200,700" rel="stylesheet" type="text/css">

        <link rel="stylesheet" type="text/css" href="../css/default.css" />
    </head>
    <body>
        <div id="tnc-background"></div>
        <script>
(function() {
    var imageNames = [
        
        'images/cover/jump.jpg',
        
        'images/cover/newyork.jpg',
        
        'images/cover/river.jpg',
        
        'images/cover/windmill.jpg',
        
    ];
    var img = imageNames[Math.floor(Math.random() * imageNames.length)];
    document.getElementById('tnc-background').style = 'background-image: url(\'/' + img + '\');';
})();
</script>

        <div class="tnc-main tnc-layout mdl-layout mdl-js-layout">
          <header class="mdl-layout__header mdl-layout__header--transparent mdl-layout__header--scroll">
            <!-- Top row, always visible -->
            <div class="mdl-layout__header-row">
              <!-- Title -->
              <span class="mdl-layout-title"><a href="../">Thinking and Computing</a></span>
              <div class="mdl-layout-spacer"></div>
              <!-- Navigation -->
              <nav class="mdl-navigation">
                  <a class="mdl-navigation__link" href="../">Home</a>
                  <a class="mdl-navigation__link" href="../about.html">About</a>
                  <a class="mdl-navigation__link" href="../archive.html">Archive</a>
              </nav>
            </div>
          </header>
          <div class="mdl-layout__drawer">
            <span class="mdl-layout-title">Browse T&amp;C</span>
            <nav class="mdl-navigation">
              <a class="mdl-navigation__link" href="../">Home</a>
              <a class="mdl-navigation__link" href="../about.html">About</a>
              <a class="mdl-navigation__link" href="../archive.html">Archive</a>
            </nav>
          </div>
          <main class="tnc-main mdl-layout__content">
            <div class="tnc-container mdl-grid">
              <div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>
              <div class="tnc-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col">
                  <h1>Passprot exe encryptor 0.2 released</h1>
<div class="info">
    Posted on February  7, 2014
    
</div>

<p>
I have made several improvements to my exe encryptor. <a title="Download" href="https://static.thinkingandcomputing.com/passprot_v0.2.rar" target="_blank">v0.2 download</a>
</p>
<p>
Changes:<br /> - Randomized initialization vector<br /> - Backing up registers in a scratch area in memory and recovering them before invocation of the original entry point to increase compatibility<br /> - Keeping entry point in the same section after encryption i.e. not pointing to the extra PE section housing the encryption stub. This prevents most false positives from anti-virus products.
</p>
<p>
Future plans:<br /> Some executables come with a relocation table, which records areas within the program that should be updated when the image is loaded on a different address than the preferred one stipulated in file header. After encryption, those records are no longer valid, but the Windows PE loader nonetheless alters the areas accordingly, thus corrupting the encrypted data. Maybe I should implement some custom handler for .reloc sections, or probably just strip the section altogether?
</p>
<p>
Right now passprot relies on LoadLibraryA and GetProcAddress API to locate the methods required to display windows. If the two functions are absent from the exe’s import table, passprot cannot encrypt the executable. Packing the file with UPX is a quick and dirty solution since UPX automatically adds those functions to the import table, but that coupled with encryption would again trigger a new set of anti-virus false positives.
</p>

              </div>
            </div>
          </main>
        </div>

        <script src="https://cdn.jsdelivr.net/material-design-lite/1.1.3/material.min.js" integrity="sha256-qeJNkhp5/Tnaa3Ovx49//j+Kn0Lx9ykNYJdLMxCwd1c=" crossorigin="anonymous" defer async></script>
    </body>
</html>
